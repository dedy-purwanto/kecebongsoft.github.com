<!DOCTYPE html>
<!--[if lt IE 8]>
<html class="ie" dir="ltr" lang="en-US">
<![endif]-->
<!--[if ! lt IE 8 ]><!-->
<html dir="ltr" lang="en-US">
<!--<![endif]-->

<head>
<meta charset="UTF-8" />
<link rel="stylesheet" media="all" href="http://kecebongsoft.com/theme/css/style.css" />
<script>
var templateDir = "http://kecebongsoft.com/theme/";
// make windows load system fonts
if(navigator.appVersion.indexOf("Win") != -1) {
    var windowsCss = document.createElement("link");

    windowsCss.setAttribute("rel", "stylesheet");
    windowsCss.setAttribute("media", "all");
    windowsCss.setAttribute("href", "http://kecebongsoft.com/theme/css/windows.css");

    var head = document.getElementsByTagName("head")[0];
    head.appendChild(windowsCss);

    windows = true;

} else {
    var fontCss = document.createElement("link");

    fontCss.setAttribute("rel", "stylesheet");
    fontCss.setAttribute("media", "all");
    fontCss.setAttribute("href", "http://kecebongsoft.com/theme/css/fonts-1-2.css");

    var head = document.getElementsByTagName("head")[0];
    head.appendChild(fontCss);
}
</script>
<script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
<script src="http://code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
<script src="http://kecebongsoft.com/theme/js/moment-with-langs.js"></script>

<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:locale" content="en_US" />

<meta property="og:type" content="article" />
<meta property="og:title" content="Mengenal Google Channel API - Part 1" />
<meta property="og:description" content="Di dalam Google Application Engine (GAE) , dikenal sebuah service yg disebut Channel API . Channel API memungkinkan kita untuk membuat koneksi yang lebih realtime antara aplikasi dan GAE server. Channel API membuat kita bisa mengirimkan pesan spesifik ke client tertentu. Contohnya, jika aplikasi kita sedang melayani 1000 client, maka kita bisa ..." />
<meta property="og:url" content="2011/01/mengenal-google-channel-api-part-1.html" />


<title>Dedi P. : Mengenal Google Channel API - Part 1</title>

<link href="http://kecebongsoft.com/" type="application/atom+xml" rel="alternate" title="Dedi P. ATOM Feed" />

<!--[if lt IE 9]>
        <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

</head>

<body>

    <article id='content'>
        <header> <a id="logo" href="http://kecebongsoft.com">Dedi P.</a> </header>
        

<section id="post">
    <h1 class="section_separator">
        <span>Sat 29 January 2011</span>
    </h1>
    <article id="" class="post">

        <h1 class="post_title">Mengenal Google Channel API - Part 1</h1>
        <p>Di dalam
<a href="http://code.google.com/appengine/">
 Google Application Engine (GAE)
</a>
, dikenal sebuah service yg disebut
<a href="http://code.google.com/appengine/docs/python/channel/overview.html">
 Channel API
</a>
. Channel API memungkinkan kita untuk membuat koneksi yang lebih realtime antara aplikasi dan GAE server. Channel API membuat kita bisa mengirimkan pesan spesifik ke client tertentu. Contohnya, jika aplikasi kita sedang melayani 1000 client, maka kita bisa mengirimkan pesan yang hanya akan diterima oleh client tertentu. Aplikasi yang cocok menggunakan Channel API contohnya aplikasi chat, multiplayer game, dan aplikasi lainnya yang sifatnya kolaboratif.
<strong>
 Kenapa pakai Channel API?
</strong>
Kita pernah membuat aplikasi realtime yang simpel, contohnya chat. Dimana semua user berkumpul di satu chat server, lalu pesan chat akan terkirim ke semua user. Solusi yang paling simpel adalah menggunakan polling. Dimana client (AJAX) akan melakukan frequent request ke server untuk meminta data, lalu data yang didapat akan di download ke client. Jika ada 1000 user di chat server, dan polling dilakukan setiap 3 detik, maka tiap 3 detik server akan menghandle 3000 request, ini belum termasuk dengan post processing, seperti regex, text formatting, dll. Padahal dalam 3 detik tersebut data chat bisa saja sama dengan yang sebelumnya. Bayangkan berapa banyak resource server yang terpakai jika harus memakai solusi polling?.
<!--more-->
Berbeda dengan Channel API, server bisa mengatur kapan pesan chat harus dikirimkan. Jika tidak ada chat yang baru, server bisa idle sampai ada user yang mengirim pesan, kemudian baru pesan tersebut dikirimkan ke semua client. Jika ada 1000 orang di chat server, dan tidak ada yang mengirim pesan chat selama 5 menit, maka server tidak akan melakkukan apapun, kemudian jika ada yang mengirim pesan di menit ke enam, barulah server mengirimkan pesan tersebut ke semua client.</p>
<p>Kelebihan lainnya dari Channel API adalah, tersedianya "channel" unik untuk setiap client. Ini memungkinkan kita untuk mengirim pesan ke client tertentu. Pada kasus chat diatas, saya bisa mengirim private message ke user-user tertentu.
<strong>
 Implementasi sederhana Channel API
</strong>
Sebelum bergerak ke code, hakikat paling dasar Channel API adalah koneksi 2 arah. Ini berarti, Channel API hanya bisa mengirim pesan ke 1 client untuk setiap eksekusinya. Hingga saat ini Channel API masih terbilang muda dan belum punya fungsi built-in broadcast message.</p>
<p>Ada beberapa istilah penting di Channel API yang harus kita pahami:
<ol>
 <li>
  <strong>
   Server
  </strong>
  , adalah aplikasi yang kita host di GAE.
 </li>
 <li>
  <strong>
   Client
  </strong>
  , adalah browser. Jika di komputer ada dua browser/tab/window yang membuka aplikasi kita, maka akan terhitung sebagai 2 client.
 </li>
 <li>
  <strong>
   Channel
  </strong>
  , adalah "pipa" eksklusif yang disediakan bagi setiap client ke server. Jika kita buka aplikasi GAE dengan 2 browser, maka kita punya 2 channel. Sehingga jika aplikasi kita hanya mengirimkan pesan ke channel pertama, channel kedua tidak akan dapat, begitu juga sebaliknya.
 </li>
 <li>
  <strong>
   Client ID
  </strong>
  , adalah serangkaian kata kunci unik yang kita susun untuk membuat sebuah channel. Contohnya, kita bisa membuat sebuah channel berdasarkan username.
 </li>
 <li>
  <strong>
   Token
  </strong>
  , adalah hash dari Client ID, digunakan oleh client untuk melakukan koneksi dan listening ke server.
 </li>
 <li>
  <strong>
   Message
  </strong>
  , adalah isi dari setiap pesan yang dikirimkan dari atau untuk client/server.
 </li>
</ol>
Kita akan bahas lebih jelas tentang istilah-istilah diatas dibagian implementasi, mekanisme Channel API adalah sebagai berikut:
<ol>
 <li>
  Server membuat satu channel unik yang hanya boleh dipakai oleh 1 client. Contoh untuk aplikasi chat, kita akan buat channel berdasarkan username. Misalkan createChannel("dedi_purwanto");. "dedi_purwanto" adalah Client ID.
 </li>
 <li>
  Kemudian fungsi tersebut akan menghasilkan sebuah hash (misal: "abc123xyz"), yang kita sebut dengan Token. Token ini harus di pass ke javascript.
 </li>
 <li>
  Client (javascript) akan membuka koneksi Channel API ke server dengan menggunakan token yang sudah dikirimkan tadi. Ketika javascript membuka koneksi dengan token tadi, server akan mencocokan dengan semua Client ID yang terdaftar di server, jika ditemukan yang cocok (yaitu "dedi_purwanto"), maka koneksi javascript tadi adalah valid, dan client akan mulai melakukan listening ke server terhadap semua pesan yang masuk/keluar.
 </li>
 <li>
  Client dan server melakukan listening.
 </li>
</ol>
Well, sementara itu dulu untuk pengenalan channel API, dibagian selanjutnya akan dijelaskan tentang contoh code untuk koneksi dua arah, serta solusi untuk broadcast message, stay tuned :D
<a href="http://kecebongsoft.wordpress.com/2011/01/30/mengenal-google-channel-api-part-2">
 <em>
  (Bersambung di Part 2)
 </em>
</a></p>
        <span class="post_fleuron symbol">Ð</span>

        <div id='comments'></div>

<script>
$(function(){

    function format_comment(name, comment, comment_date) {
        moment.lang('id');
        comment_date = moment(comment_date);

        return  "<div class='comment' style='margin-bottom:20px;'><span style='font-weight:bold;'>" + name + "</span> " + 
        "<span style='color:#acacac'>" + comment_date.format('Do MMMM YYYY') + "</span><br />" + "<p style='color:#8a8a8a'>" + comment + "</p></div>";
    }

    $.getJSON("http://kecebongsoft-blog-comments.appspot.com/get/?url=2011/01/mengenal-google-channel-api-part-1.html", function(data){
        comments = data['comments'];

        form_html = "<form method='post' action=''>" +
            "<input type='text' id='name' name='name' placeholder='Nama' style='border:none;background-color:inherit;border-bottom:1px dotted #acacac;width:100%' ><br />" +
            "<textarea name='comment' id='comment' placeholder='Komentar' style='border:none;background-color:inherit;border-bottom:1px dotted #acacac;width:100%;height:70px;'></textarea><br />" +
            "<div style='float:right'><a id='comment_submit' href='#'>Kirim</a></div>" +
            "<div style='clear:both;'></div>" + 
            "</form>";
            
        
        comment_list = "";
        comment_list += "<div id='comment_list'>";
        comment_list += "<div id='form'>" + form_html + "</div><div id='comments'>";
        if (comments.length > 0) {

            $("#comments").append("" +
                "<h3 style='text-align:center;'>" +
                    "<a href='#' id='comments_toggle'>Lihat komentar (" + comments.length + ")</a>" +
                    "</h3>");




            for (i = 0; i < comments.length ; i += 1 ) {
                c = comments[i];
                comment_list += format_comment(c['name'], c['comment'], c['date']);
            }




        } else {
            $("#comments").append("<h3 style='text-align:center;'><a href='#' id='comments_toggle'>Kirim komentar</a></h3>");
        }

        comment_list += "</div></div>";
        $("#comments").append(comment_list);

        $("#comments #comment_list #form #comment_submit").click(function(e){
            e.preventDefault();

            $name = $("#comments #comment_list #form form #name");
            $comment = $("#comments #comment_list #form form #comment");

            if ($name.val() == '' || $comment.val() == '') {
                console.log('type first');
            }else{
                console.log($name.val());
                console.log($comment.val());
                $.getJSON('http://kecebongsoft-blog-comments.appspot.com/post/?url=2011/01/mengenal-google-channel-api-part-1.html&name=' + 
                    $name.val() + '&comment=' + $comment.val(), function(new_comment){

                    $("#comments #comment_list #comments").prepend(format_comment(new_comment['name'], new_comment['comment'], new_comment['date']));

                    $name.val('');
                    $comment.val('');
                });

            }

            return false;
        });
        $("#comments #comment_list").hide();
        $("#comments_toggle").click(function(e){
            e.preventDefault();
            $("#comment_list").show();
            return false;
        });
    });

});
</script>
        

    </article>

</section>

        <footer>
            <h1 class="section_separator"><span></span></h1>
            <nav>
                <a href='/2001/01/about.html' class='site-links'>Siapa saya</a> | 
                <a href='/archives.html' class='site-links'>Arsip tulisan</a>
            </nav>
            <span>&copy;&nbsp;2004-2014 Dedi Purwanto</span>
        </footer>
    </article>



    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
        var pageTracker = _gat._getTracker("UA-36468240-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>
</body>
</html>