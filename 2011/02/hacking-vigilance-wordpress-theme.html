<!DOCTYPE html>
<!--[if lt IE 8]>
<html class="ie" dir="ltr" lang="en-US">
<![endif]-->
<!--[if ! lt IE 8 ]><!-->
<html dir="ltr" lang="en-US">
<!--<![endif]-->

<head>
<meta charset="UTF-8" />
<link rel="stylesheet" media="all" href="http://kecebongsoft.com/theme/css/style.css" />
<script>
var templateDir = "http://kecebongsoft.com/theme/";
// make windows load system fonts
if(navigator.appVersion.indexOf("Win") != -1) {
    var windowsCss = document.createElement("link");

    windowsCss.setAttribute("rel", "stylesheet");
    windowsCss.setAttribute("media", "all");
    windowsCss.setAttribute("href", "http://kecebongsoft.com/theme/css/windows.css");

    var head = document.getElementsByTagName("head")[0];
    head.appendChild(windowsCss);

    windows = true;

} else {
    var fontCss = document.createElement("link");

    fontCss.setAttribute("rel", "stylesheet");
    fontCss.setAttribute("media", "all");
    fontCss.setAttribute("href", "http://kecebongsoft.com/theme/css/fonts-1-2.css");

    var head = document.getElementsByTagName("head")[0];
    head.appendChild(fontCss);
}
</script>

<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>Dedi P. : Hacking Vigilance Wordpress Theme</title>

<link href="http://kecebongsoft.com/" type="application/atom+xml" rel="alternate" title="Dedi P. ATOM Feed" />

<!--[if lt IE 9]>
        <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

</head>

<body>

    <article id='content'>
        <header> <a id="logo" href="http://kecebongsoft.com">Dedi P.</a> </header>
        

<section id="post">
    <h1 class="section_separator">
        <span>Tue 22 February 2011</span>
    </h1>
    <article id="post-9337" class="post">

        <h1 class="post_title">Hacking Vigilance Wordpress Theme</h1>
        <p>(
<a href="http://kecebongsoft.wordpress.com/2011/02/22/hacking-theme-wordpress-vigilance/">
 Versi Indonesia Disini
</a>
) Few days ago, I was quite bored at 3AM and decided to decorate my Wordpress theme. I&#8217;ve been using Vigilance theme for a while and I think it is a good theme, except that there are stuff I don&#8217;t really like, such as some colors and positioning. Unfortunately I can&#8217;t change most part of the theme since I didn&#8217;t apply for premium account. Here was the screenshot of my original Vigilance theme:</p>
<p><img alt="image" src="/img/wordpress/2011-02-blogoriginal.jpg?w=300" />
<!--more-->
In a free account, Vigilance only provides some features to change the colors of some elements. Better than doing nothing, I rather change the link color from default red to dark blue through these options:</p>
<p><img alt="image" src="/img/wordpress/2011-02-colorschemeori.jpg?w=300" /></p>
<p>No big deal right? I just have to click the color picker and change the color value. But suddenly a random thought flows in my head, few years back I wrote an article about hacking a web page through CSS inputs.
<a href="http://kecebongsoft.wordpress.com/2008/09/06/hacking-trick-css-injection/">
 This article was written in Bahasa Indonesia
</a>
. I have this stupid thought about trying this trick in Wordpress theme, I thought it was stupid because Wordpress is such as giant service and there&#8217;s no way this kind of vulnerable exists in their system.</p>
<p>The idea is to inject CSS codes in the input field, followed by other codes as you wish. This is almost same as SQL Injection. If the coder wrote this:</p>
<div class="highlight"><pre>
</pre></div>


<p>echo &#8220;body{background-color: $color;}&#8221;;</p>
<p>Color variable by default suppose to be a hex color value such as #FFFFFF. But if there&#8217;s no sanitation in the flow, we can actually inject the hex value. Suppose that the hex value can be modified through a text field like in the Vigilance theme options, then we can actually put this:</p>
<div class="highlight"><pre>
</pre></div>


<h1>FFFFFF;font-size:11px</h1>
<p>I am injecting an additional CSS attribute (font-size) into the text field. It will work since there&#8217;s no validation! The output code will be like this:</p>
<div class="highlight"><pre>
</pre></div>


<p>body{background-color: #FFFFFF;font-size:11px;}</p>
<p>No, it&#8217;s not just that, I can even add more CSS class or modify the existing one, look at my input:</p>
<div class="highlight"><pre>
</pre></div>


<h1>FFFFFF;} .footer, .date {display:none} {</h1>
<p>See? I can easily remove the footer and date field in my theme. And I also put an additional curly bracket at the end of the input, so the output will be like this:</p>
<div class="highlight"><pre>
</pre></div>


<p>body{background-color: #FFFFFF;} .footer, .date {display:none} {;}</p>
<p>Without applying for premium account, I can modify my CSS theme without any limit. But the fun hasn&#8217;t end yet, I can put HTML and JS code as well! Look at my input:</p>
<div class="highlight"><pre>
</pre></div>


<h1>FFFFFF;} &lt;/style&gt; &lt;b&gt;Hello World!&lt;/b&gt;&lt;script&gt;alert(&#8220;Hello World!&#8221;);&lt;/script&gt; &lt;style&gt; {</h1>
<p>There it is, I am injecting a HTML and a simple javascript code into my CSS input, and the list will infinitely goes on from this, you can almost add anything, name it, flash, iframe, videos, anything.</p>
<p>Here is the modification I made for my Vigilance theme:</p>
<div class="highlight"><pre>
</pre></div>


<p>Background Color:
 #ffffff;}&lt;/style&gt; &lt;link href='//fonts.googleapis.com/css?family=Cantarell:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css' &gt; &lt;style&gt; body {&#160;&#160; font-family: 'Cantarell', serif;&#160;&#160; text-shadow: 2px 2px 2px #bbb; } &lt;/style&gt; &lt;style type='text/css' media='screen'&gt; {</p>
<p>linkColor:
 #3b72b5;} #title span{color:#3b72b5;} #description{float:none;width:100%;text-align:center;margin-top:-70px;margin-bottom:10px;} #nav, .author, .tags, .categories, #footer{display:none} .post-header{border:none;padding:0px}&#160; #content{width: 650px;} #sidebar{width: 250px;} .post .date{font-size:11px;text-align:right;} #sidebar a{font-size:12px;} {</p>
<p>Here is the screenshot of my modification:</p>
<p><img alt="image" src="/img/wordpress/2011-02-colorschemehacked.jpg?w=300" /></p>
<p>In this modification, I changed the default font to Google Web Font, and I even add the font shadow. Also, I changed many things in the theme such as the title and description placement, removing tags, categories and footer, changing the column width, etc.</p>
<p>Here is the result of my code:</p>
<p><img alt="image" src="/img/wordpress/2011-02-bloghacked.jpg?w=300" /></p>
<p>That&#8217;s it, I leave it like that for almost 2 days. It seems like no Wordpress admin aware about my changes. I am not sure whether they knew about this vulnerable or not. So I am writing this post as well as a report to them, and I changed back my theme to the default one right before I wrote this blog post. Hopefully they will fix it, in case they haven't, you can try it on your own. Change your theme to Vigilance, and go to Theme Options, have fun :D</p>
        <span class="post_fleuron symbol">Ð</span>

    </article>

</section>

    </article>


    <footer>
        <h1 class="section_separator"><span></span></h1>
        <nav>
            <a href='/2001/01/about.html' class='site-links'>Siapa saya</a> | 
            <a href='/archives.html' class='site-links'>Arsip tulisan</a>
        </nav>
        <span>&copy;&nbsp;2004-2014 Dedi Purwanto</span>
    </footer>

    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
        var pageTracker = _gat._getTracker("UA-36468240-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>
</body>
</html>