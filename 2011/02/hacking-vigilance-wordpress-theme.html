<!DOCTYPE html>
<html lang="en-US">
    <head>
        <meta charset="utf-8"> 
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Dedy Purwanto" />
        <meta name="copyright" content="Dedy Purwanto" />
        <meta property="fb:admins" content="kecebongsoft" />

<meta name="keywords" content=", Komputer, " />
        <title>Hacking Vigilance Wordpress Theme  · Dedy Purwanto
</title>
        <link href="http://cdn-images.mailchimp.com/embedcode/slim-081711.css" rel="stylesheet" type="text/css">
        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/css/bootstrap-combined.min.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="http://kecebongsoft.com/theme/css/style.css" media="screen">
        <link rel="stylesheet" type="text/css" href="http://kecebongsoft.com/theme/css/solarizedlight.css" media="screen">
        <link rel="shortcut icon" href="http://kecebongsoft.com/theme/images/favicon.ico" type="image/x-icon" />
        <link rel="apple-touch-icon" href="http://kecebongsoft.com/theme/images/apple-touch-icon.png" />
        <link rel="apple-touch-icon" sizes="57x57" href="http://kecebongsoft.com/theme/images/apple-touch-icon-57x57.png" />
        <link rel="apple-touch-icon" sizes="72x72" href="http://kecebongsoft.com/theme/images/apple-touch-icon-72x72.png" />
        <link rel="apple-touch-icon" sizes="114x114" href="http://kecebongsoft.com/theme/images/apple-touch-icon-114x114.png" />
        <link rel="apple-touch-icon" sizes="144x144" href="http://kecebongsoft.com/theme/images/apple-touch-icon-144x144.png" />
        <link rel="icon" href="http://kecebongsoft.com/theme/images/apple-touch-icon-144x144.png" />
        <link href="http://kecebongsoft.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Dedy Purwanto - Full Atom Feed" />
        <link href="http://kecebongsoft.com/feeds/Komputer.atom.xml" type="application/atom+xml" rel="alternate" title="Dedy Purwanto - Komputer Category Atom Feed" />
        <link href="http://kecebongsoft.com/feeds/Personal.atom.xml" type="application/atom+xml" rel="alternate" title="Dedy Purwanto - Personal Category Atom Feed" />
        <link href="http://kecebongsoft.com/feeds/Perspektif.atom.xml" type="application/atom+xml" rel="alternate" title="Dedy Purwanto - Perspektif Category Atom Feed" />
    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-36468240-1']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
    </head>
    <body>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&appId=1507469096175247&version=v2.0";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>        <div id="content-sans-footer">
        <div class="navbar navbar-static-top">
            <div class="navbar-inner">
                <div class="container">
                    <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </a>
                    <a class="brand" href="http://kecebongsoft.com/"><span class=site-name>Dedy Purwanto</span></a>
                    <div class="nav-collapse collapse">
                        <ul class="nav pull-right top-menu">
                            <li ><a href="http://kecebongsoft.com">Home</a></li>
                            <li ><a href="http://kecebongsoft.com/categories.html">Kategori</a></li>
                            <!--
                            <li ><a href="http://kecebongsoft.com/tags.html">Tags</a></li>
                            -->
                            <li ><a href="http://kecebongsoft.com/archives.html">Arsip</a></li>
                            <li><form class="navbar-search" action="http://kecebongsoft.com/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Cari.." name="q" id="tipue_search_input"></form></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="container-fluid">
            <div class="row-fluid">
                <div class="span1"></div>
                <div class="span10">
<article>
<div class="row-fluid">
    <header class="page_header span10 offset2">
    <h1><a href="http://kecebongsoft.com/2011/02/hacking-vigilance-wordpress-theme.html"> Hacking Vigilance Wordpress Theme  </a></h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">

            <p>(
<a href="http://kecebongsoft.wordpress.com/2011/02/22/hacking-theme-wordpress-vigilance/">
 Versi Indonesia Disini
</a>
) Few days ago, I was quite bored at 3AM and decided to decorate my Wordpress theme. I&#8217;ve been using Vigilance theme for a while and I think it is a good theme, except that there are stuff I don&#8217;t really like, such as some colors and positioning. Unfortunately I can&#8217;t change most part of the theme since I didn&#8217;t apply for premium account. Here was the screenshot of my original Vigilance theme:</p>
<p><img alt="image" src="/img/wordpress/2011-02-blogoriginal.jpg?w=300" />
<!--more-->
In a free account, Vigilance only provides some features to change the colors of some elements. Better than doing nothing, I rather change the link color from default red to dark blue through these options:</p>
<p><img alt="image" src="/img/wordpress/2011-02-colorschemeori.jpg?w=300" /></p>
<p>No big deal right? I just have to click the color picker and change the color value. But suddenly a random thought flows in my head, few years back I wrote an article about hacking a web page through CSS inputs.
<a href="http://kecebongsoft.wordpress.com/2008/09/06/hacking-trick-css-injection/">
 This article was written in Bahasa Indonesia
</a>
. I have this stupid thought about trying this trick in Wordpress theme, I thought it was stupid because Wordpress is such as giant service and there&#8217;s no way this kind of vulnerable exists in their system.</p>
<p>The idea is to inject CSS codes in the input field, followed by other codes as you wish. This is almost same as SQL Injection. If the coder wrote this:</p>
<div class="highlight"><pre>
</pre></div>


<p>echo &#8220;body{background-color: $color;}&#8221;;</p>
<p>Color variable by default suppose to be a hex color value such as #FFFFFF. But if there&#8217;s no sanitation in the flow, we can actually inject the hex value. Suppose that the hex value can be modified through a text field like in the Vigilance theme options, then we can actually put this:</p>
<div class="highlight"><pre>
</pre></div>


<h1>FFFFFF;font-size:11px</h1>
<p>I am injecting an additional CSS attribute (font-size) into the text field. It will work since there&#8217;s no validation! The output code will be like this:</p>
<div class="highlight"><pre>
</pre></div>


<p>body{background-color: #FFFFFF;font-size:11px;}</p>
<p>No, it&#8217;s not just that, I can even add more CSS class or modify the existing one, look at my input:</p>
<div class="highlight"><pre>
</pre></div>


<h1>FFFFFF;} .footer, .date {display:none} {</h1>
<p>See? I can easily remove the footer and date field in my theme. And I also put an additional curly bracket at the end of the input, so the output will be like this:</p>
<div class="highlight"><pre>
</pre></div>


<p>body{background-color: #FFFFFF;} .footer, .date {display:none} {;}</p>
<p>Without applying for premium account, I can modify my CSS theme without any limit. But the fun hasn&#8217;t end yet, I can put HTML and JS code as well! Look at my input:</p>
<div class="highlight"><pre>
</pre></div>


<h1>FFFFFF;} &lt;/style&gt; &lt;b&gt;Hello World!&lt;/b&gt;&lt;script&gt;alert(&#8220;Hello World!&#8221;);&lt;/script&gt; &lt;style&gt; {</h1>
<p>There it is, I am injecting a HTML and a simple javascript code into my CSS input, and the list will infinitely goes on from this, you can almost add anything, name it, flash, iframe, videos, anything.</p>
<p>Here is the modification I made for my Vigilance theme:</p>
<div class="highlight"><pre>
</pre></div>


<p>Background Color:
 #ffffff;}&lt;/style&gt; &lt;link href='//fonts.googleapis.com/css?family=Cantarell:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css' &gt; &lt;style&gt; body {&#160;&#160; font-family: 'Cantarell', serif;&#160;&#160; text-shadow: 2px 2px 2px #bbb; } &lt;/style&gt; &lt;style type='text/css' media='screen'&gt; {</p>
<p>linkColor:
 #3b72b5;} #title span{color:#3b72b5;} #description{float:none;width:100%;text-align:center;margin-top:-70px;margin-bottom:10px;} #nav, .author, .tags, .categories, #footer{display:none} .post-header{border:none;padding:0px}&#160; #content{width: 650px;} #sidebar{width: 250px;} .post .date{font-size:11px;text-align:right;} #sidebar a{font-size:12px;} {</p>
<p>Here is the screenshot of my modification:</p>
<p><img alt="image" src="/img/wordpress/2011-02-colorschemehacked.jpg?w=300" /></p>
<p>In this modification, I changed the default font to Google Web Font, and I even add the font shadow. Also, I changed many things in the theme such as the title and description placement, removing tags, categories and footer, changing the column width, etc.</p>
<p>Here is the result of my code:</p>
<p><img alt="image" src="/img/wordpress/2011-02-bloghacked.jpg?w=300" /></p>
<p>That&#8217;s it, I leave it like that for almost 2 days. It seems like no Wordpress admin aware about my changes. I am not sure whether they knew about this vulnerable or not. So I am writing this post as well as a report to them, and I changed back my theme to the default one right before I wrote this blog post. Hopefully they will fix it, in case they haven't, you can try it on your own. Change your theme to Vigilance, and go to Theme Options, have fun :D</p>
            <aside>
            <hr/>
            <nav>
            <ul class="articles_timeline">
 
                <li class="previous_article">« <a href="http://kecebongsoft.com/2011/02/cloud-hosting-sebagai-bahan-belajar.html" title="Previous: Cloud hosting sebagai bahan belajar">Cloud hosting sebagai bahan belajar</a></li>
 
                <li class="next_article"><a href="http://kecebongsoft.com/2011/02/hacking-theme-wordpress-vigilance.html" title="Next: Hacking Theme Wordpress (Vigilance)">Hacking Theme Wordpress (Vigilance)</a> »</li>
            </ul>
<div class="fb-comments" data-href="http://kecebongsoft.com/2011/02/hacking-vigilance-wordpress-theme.html" data-numposts="5" data-colorscheme="light"></div>            </nav>
            </aside>
        </div>
        <section>
        <div class="span2" style="float:right;font-size:0.9em;">
 
            <h4>Ditulis</h4>
            <time pubdate="pubdate" datetime="2011-02-22T02:12:35">Feb 22, 2011</time>
            <h4>Kategori</h4>
            <a class="category-link" href="/categories.html#Komputer-ref">Komputer</a> 

        </div>
        </section>
</div>
</article>
                </div>
                <div class="span1"></div>
            </div>
        </div>
    </div>
<footer>
<div id="footer">
    <ul class="footer-content">
        <li class="elegant-subtitle"><span class="site-name">Dedy Purwanto</span> - &copy;2004-2015 Dedy Purwanto</li>
        <li class="elegant-power">Powered by <a href="http://getpelican.com/" title="Pelican Home Page">Pelican</a>. Theme: <a href="http://oncrashreboot.com/pelican-elegant" title="Theme Elegant Home Page">Elegant</a> by <a href="http://oncrashreboot.com" title="Talha Mansoor Home Page">Talha Mansoor</a></li>
    </ul>
</div>
</footer>            <script src="http://code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/js/bootstrap.min.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    </body>
</html>